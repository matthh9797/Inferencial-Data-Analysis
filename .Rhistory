?tq
?qt
qt(0.95, 15)
qt(0.05, 15)
qt(0.95, 20)
qt(0.95, 100)
qnorm(10.95)
qnorm(0.95)
qt(0.95, 10000)
qt(0.95, 25)
t.test(father.son$sheight - father.son$sheight)
head(father.son)
t.test(father.son$sheight - father.son$fheight)
diff <- father.son$sheight - father.son$fheight
(mean(diff)*sqrt(1078))/sd(diff)
t.test(gain ~ Diet, paired = FALSE, var.equal = FALSE, data = wideCW14)
t.test(gain ~ Diet, paired = FALSE, var.equal = TRUE
, data = wideCW14)
library(ggplot2)
df <- data.frame(
x = c(4,8,7),
)
df <- data.frame(
x = c(4,8,7),
y = c(2, 4, 9),
label = c("a", "b", "c")
)
df
p <- ggplot(df, aes(x, y, label = label)) + labs
p <- ggplot(df, aes(x, y, label = label)) + labs(x = NULL, y = NULL) + theme(plot.title = element_text(size = 12))
p + geom_text() + ggtitle("text")
p + geom_tile() + ggtitle("raster")
p + geom_area() + ggtitle("area")
p + geom_polygon() + ggtitle("polygon")
p + geom_line() + ggtitle("line")
p + geom_path() + ggtitle("path")
p + geom_barplot(stat = "identity")
p + geom_bar(stat = "identity")
p + geom_pie()
pie <- ggplot(df, aes(x = "", y = y, fill = label)) + geom_bar(stat = "identity", width = 1)
pie
pie + coord_polar("y", start = 0)
df <- data.frame(x = 1, y = 3:1, family = c("sans", "serif", "mono"))
ggplot(df, aes(x,y)) + geom_text(aes(label = family, family = family)
)
df <- data.frame(x = 1, y = 3:1, family = c("plain", "bold", "italic"))
ggplot(df, aes(x,y)) + geom_text(label = family, fontface = family)
ggplot(df, aes(x,y)) + geom_text(aes(label = family, fontface = family))
df <- data.frame(
x = c(1,1,2,2,1.5),
y = c(1,2,1,2,1.5),
text = c("bottom-left", "bottom-right",
"top-left", "top-right", "center")
)
ggplot(df, aes(x,y)) + geom_text(aes(label = text))
ggplot(df, aes(x,y)) + geom_text(aes(label = text), vjust = "inward", hjust = "inward")
df <- data.frame(trt = c("a", "b", "c"), resp = c(1.2, 3.4, 2.5))
ggplot(df, aes(trt, resp)) + geom_point() + geom_text(aes(label = paste0("(", resp, ")")), nudge_y = -0.25) + xlim(1,3.6)
ggplot(df, aes(resp, trt)) + geom_point() +
geom_text(aes(label = paste0("(", resp, ")")), nudge_y = -0.25) +
xlim(1,3.6)
head(faithfuld)
label <- data.frame(
waiting = c(55, 80),
eruptions = c(2, 4.3),
label = c("peak one", "peak two")
)
ggplot(faithfuld, aes(waiting, eruptions)) +
geom_tile(aes(fill = density)) +
geom_label(data = label, aes(label = label))
g <- ggplot(mpg, aes(displ, hwy, colour = class))
g + geom_point()
install.packages("directlabels")
g + geom_point(show.legend = FALSE) +
directlabels::geom_dl(aes(label = class), method = "smart.grid")
head(economics)
head(presidential)
presidential <- subset(presidential, start > economics$date[1])
presidential
g <- ggplot(economics) +
geom_rect(
aes(xmin = start, xmax = end, fill = party,
ymin = -Inf, ymax = Inf, alpha = 0.2, data = presidential)
)
g <- ggplot(economics) +
geom_rect(
aes(xmin = start, xmax = end, fill = party),
ymin = -Inf, ymax = Inf, alpha = 0.2, data = presidential
)
g + geom_vline(
aes(xintercept = as.numeric(start)),
data = presidential,
colour = "grey50", alpha = 0.5
) +
geom_text(
aes(x = start, y = 2500, label = name),
data = presidential,
size = 3, vjust = 0, hjust = 0, nudge_x = 50
) +
geom_line(aes(data, unemploy)) +
scale_fill_manual(values = c("blue", "red"))
rlang::last_error()
rlang::last_trace()
head(economics)
head(presidential)
g
summary(g)
g <- g + geom_vline(
aes(xintercept = as.numeric(start)),
)
g <- ggplot(economics) +
geom_rect(
aes(xmin = start, xmax = end, fill = party),
ymin = -Inf, ymax = Inf, alpha = 0.2, data = presidential
)
g <- g + geom_vline(
aes(xintercept = as.numeric(start)),
data = presidential,
colour = "grey50", alpha = 0.5
)
g
g + geom_text(
aes(x = start, y = 2500, label = name),
data = presidential,
size = 3, vjust = 0, hjust = 0, nudge_x = 50
)
head(presidential)
g <- g + geom_text(
aes(x = start, y = 2500, label = name),
data = presidential,
size = 3, vjust = 0, hjust = 0, nudge_x = 50
)
g + geom_line(aes(data, unemploy)) +
scale_fill_manual(values = c("blue", "red"))
head(economics)
summary(g)
g + geom_line(aes(data, unemploy)) +
scale_fill_manual(values = c("blue", "red"))
g + geom_line(aes(date, unemploy)) +
scale_fill_manual(values = c("blue", "red"))
g + geom_line(aes(data, unemploy), size = 2) +
scale_fill_manual(values = c("blue", "red"))
?geom_line
g + geom_line(aes(date, unemploy), size = 2) +
scale_fill_manual(values = c("blue", "red"))
g + geom_line(aes(date, unemploy), size = 1.5) +
scale_fill_manual(values = c("blue", "red"))
g + geom_line(aes(date, unemploy), size = 1) +
scale_fill_manual(values = c("blue", "red"))
g + geom_line(aes(date, unemploy)) +
scale_fill_manual(values = c("blue", "red"))
g <- g + geom_text(
aes(x = start, y = 2500, label = name),
data = presidential,
size = 3, vjust = 0, hjust = 0, nudge_x = 70
)
g + geom_line(aes(date, unemploy)) +
scale_fill_manual(values = c("blue", "red"))
g <- g + geom_text(
aes(x = start, y = 2500, label = name),
data = presidential,
size = 3, vjust = 0, hjust = 0, nudge_x = 100
)
g + geom_line(aes(date, unemploy)) +
scale_fill_manual(values = c("blue", "red"))
g <- g + geom_text(
aes(x = start, y = 2500, label = name),
data = presidential,
size = 3, vjust = 0, hjust = 0, nudge_x = 50
)
g + geom_line(aes(date, unemploy)) +
scale_fill_manual(values = c("blue", "red"))
head(economics)
g + geom_line(aes(date, unemploy / pop)) +
scale_fill_manual(values = c("blue", "red"))
g <- g + geom_text(
aes(x = start, y = 0.01, label = name),
data = presidential,
size = 3, vjust = 0, hjust = 0, nudge_x = 50
)
g + geom_line(aes(date, unemploy / pop)) +
scale_fill_manual(values = c("blue", "red"))
library(swirl)
swirl()
myplot(2)
myplot(20)
myplot2(2)
qt(0.975, 2)
myplot2(20)
sleep
range(g1)
range(g2)
difference <- g2 - g1
mean(difference)
s <- sd(difference)
mn + c(-1,1) * qt(0.975, 9) * (s / 3)
mn + c(-1,1) * qt(0.975, 9) * (s / sqrt(10))
mn + c(-1,1) * qt(0.975, 9) * s / sqrt(10)
t.test(difference)$conf.int
sp <- (8-1)*15.34^2 + (21-1)*(18.23)^2
ns <- 27
sp <- sqrt(sp / ns)
(132.86-127.44) + c(-1,1)*qt(0.975, ns) * sp * (1/8 + 1/21)
132.86-127.44+c(-1,1)*qt(.975,ns)*sp*sqrt(1/8+1/21)
sp <- sqrt((9*var(g1) + 9*var(g2) / 18))
sp <- sqrt((9*var(g1)+9*var(g2))/18)
sp * sqrt(1/10+1/10)
md + c(-1,1)*qt(.975,18)*sp*sqrt(1/5)
t.test(g2,g1,paired = FALSE, var.equal = TRUE)$conf
t.test(g2,g1,paired = TRUE
)$conf
num <- (15.34/8 + 18.23/21)^2
num <- (15.34^2/8 + 18.23^2/21)^2
den <-15.34^4/8^2/7 + 18.23^4/21^2/20
ymdf <- num/den
mydf <- num/den
132.86-127.44+c(-1,1)*qt(0.975,mydf)*(15.34^2/8+18.23^2/21)
132.86-127.44 +c(-1,1)*qt(.975,mydf)*sqrt(15.34^2/8 + 18.23^2/21
)
0
library(swirl)
swirl
swirl()
1
2
0.8
15
qt(0.95, 15)
dim(fs)
t.test(fs$sheight, fs$fheight, paired = TRUE)
11.7885 * sd(fs$sheight-fs$fheight)/sqrt(1078)
mybin
8
pt(2.5, 15, lower.tail = FALSE)
qnorm(0.95)
qnorm(0.99)
pnorm(2, lower.tail = FALSE)
pnorm(2)
pnorm(2, lower.tail = FALSE)
mybin
pbinom(6, size = 8,prob = .5,lower.tail = FALSE)
pbinom(7,size=8,lower.tail = TRUE)
pbinom(7,size=8,prob = 0.5,lower.tail = TRUE)
ppois(5, size = 9, lower.tail = FALSE)
ppois(9, lambda = 5, lower.tail = FALSE)
0
qt(0.975, 8)
6 / qt(0.975, 8)
2*c(-1,1)*qt(0.975, 18)*0.64/sqrt(20)
2*c(-1,1)*qt(0.975, 18)*0.64/sqrt(10)
2+c(-1,1)*qt(0.975, 18)*0.64/sqrt(10)
2+c(-1,1)*qt(0.975, 18)*0.64/sqrt(20)
library(swirl)
swirl()
myplot(34)
myplot(33.3)
myplot(30)
myplot(28)
z <- qnorm(0.95)
pnorm(30+z, mean = 30)
pnorm(30+z, mean = 30, lower.tail = FALSE)
pnorm(30+z, mean = 32)
pnorm(30+z, mean = 32, lower.tail = FALSE)
pnorm(30+z, mean = 32, sd = 1, lower.tail = FALSE)
pnorm(30+z*2, mean = 32, sd = 2, lower.tail = FALSE)
power.t.test(n = 16, delta = 2 / 4, sd = 1, type = "one.sample", alt = "one.sided")$power
power.t.test(n = 16, delta = 2, sd = 4, type = "one.sample", alt = "one.sided")$power
power.t.test(n = 16, delta = 100, sd = 200, type = "one.sample", alt = "one.sided")$power
power.t.test(power = 0.8, delta = 2 / 4, sd = 1, type = "one.sample", alt = "one.sided")$n
power.t.test(power = 0.8, delta = 2, sd = 4, type = "one.sample", alt = "one.sided")$n
power.t.test(power = 0.8, delta = 100, sd = 200, type = "one.sample", alt = "one.sided")$n
power.t.test(power = 0.8, n=26, sd=1,type = "one.sample", alt = "one.sided")$delta
power.t.test(power = 0.8, n=27, sd=1,type = "one.sample", alt = "one.sided")$delta
swirl
library(swirl)
swirl()
head(pValues)
sum(pValues < 0.05)
sum(p.adjust(pValues, method="bonferroni") < 0.05)
sum(p.adjust(pValues, method="BH") < 0.05)
tail(trueStatus)
table(pValues2 < 0.05, trueStatus)
0
24 / 500
table(p.adjust(pValues2, method="bonferroni") < 0.05, trueStatus)
table(p.adjust(pValues2, method="BH") < 0.05, trueStatus)
(75*120)/120
ln(4)
log10(4)
library(ggplot2)
head(presidential)
tail(presidential)
tail(economics)
pres <- subset(presidential, start < economics$date[1])
pres
pres <- subset(presidential, start > economics$date[1])
pres
g <- ggplot(economics)
g1 <- g +
geom_rect(aes(xmin = start, xmax = end, fill = party),
ymin = -Inf, ymax = Inf, alpha = 0.2, data = presidential)
g1
g <- g1 + geom_vline(aes(xintercept = as.numeric(start)),
data = presidential, colour = "grey50", alpha = 0.5)
g3 <- g + geom_text(aes(x = start, y = 2500, label = name),
data = presidential, size = 3, vjust = 0, hjust = 0, nudge_x = 60)
g3
g1 <- g +
geom_rect(aes(xmin = start, xmax = end, fill = party),
ymin = -Inf, ymax = Inf, alpha = 0.2, data = pres)
g <- ggplot(economics)
g1 <- g +
geom_rect(aes(xmin = start, xmax = end, fill = party),
ymin = -Inf, ymax = Inf, alpha = 0.2, data = pres)
g <- g1 + geom_vline(aes(xintercept = as.numeric(start)),
data = pres, colour = "grey50", alpha = 0.5)
g3 <- g + geom_text(aes(x = start, y = 2500, label = name),
data = pres, size = 3, vjust = 0, hjust = 0, nudge_x = 60)
g3
g4 <- g3 + geom_line(aes(date, unemploy)) + scale_fill_manual(values = c("blue", "red"))
g4
?strwrap
unemploy <- economics$unemploy
date <- economics$date
yrng <- range(unemploy)
xrng <- range(date)
strwrap("Unemployment rates in the US have varied a lot over the past 40 years", 40)
caption <- paste(strwrap("Unemployment rates in the US have varied a lot over the past 40 years", 40), collapse = "\n")
caption
caption <- paste(strwrap("Unemployment rates in the US have varied a lot over the past 40 years", 40), collapse = "`\n`")
caption
caption <- paste(strwrap("Unemployment rates in the US have varied a lot over the past 40 years", 40), collapse = ``\n``)
caption <- paste(strwrap("Unemployment rates in the US have varied a lot over the past 40 years", 40), collapse = "\n")
writeLines(caption)
caption <- paste(strwrap("Tasso di disoccupazione della Stati Uniti e molto vario nel corso del'quatodici anno", 40), collapse = "\n")
caption
writeLines(caption)
g <- ggplot(economics, aes(date, unemploy)) + geom_text(aes(x, y, label = caption), data = data.frame(x = xrng[1], y = yrng[2], caption = caption), hjust = 0, vjust = 1, size = 4)
g
xrng
g <- ggplot(economics, aes(date, unemploy)) + geom_line(), geom_text(aes(x, y, label = caption), data = data.frame(x = xrng[1], y = yrng[2], caption = caption), hjust = 0, vjust = 1, size = 4)
g <- ggplot(economics, aes(date, unemploy)) + geom_line() + geom_text(aes(x, y, label = caption), data = data.frame(x = xrng[1], y = yrng[2], caption = caption), hjust = 0, vjust = 1, size = 4)
g
caption <- paste(strwrap("Tasso di disoccupazione degli Stati Uniti e` stato molto vario negli ultimi quaranta anni", 40), collapse = "\n")
g <- ggplot(economics, aes(date, unemploy)) + geom_line() + geom_text(aes(x, y, label = caption), data = data.frame(x = xrng[1], y = yrng[2], caption = caption), hjust = 0, vjust = 1, size = 4)
g
?annotate
ggplot(economics, aes(date, unemploy)) + geom_line() + annotate("text", x = xrng[1], y = yrng[2], label = caption, hjust = 1, vjust = 1, size = 5)
ggplot(economics, aes(date, unemploy)) + geom_line() + annotate("text", x = xrng[1], y = yrng[2], label = caption, hjust = 0, vjust = 1, size = 5)
ggplot(economics, aes(date, unemploy)) + geom_line() + annotate("text", x = xrng[1], y = yrng[2], label = caption, hjust = -1, vjust = 1, size = 5)
ggplot(economics, aes(date, unemploy)) + geom_line() + annotate("text", x = xrng[1], y = yrng[2], label = caption, hjust = -0.5, vjust = 1, size = 5)
ggplot(economics, aes(date, unemploy)) + geom_line() + annotate("text", x = xrng[1], y = yrng[2], label = caption, hjust = -0.1, vjust = 1, size = 5)
ggplot(economics, aes(date, unemploy)) + geom_line() + annotate("text", x = xrng[1], y = yrng[2], label = caption, hjust = 0, vjust = 1, size = 5)
head(diamonds)
g <- ggplot(diamonds, aes(log10(price), log10(carat))) + geom_bin2d() + facet_wrap(~cut)
g
g <- ggplot(diamonds, aes(log10(price), log10(carat))) + geom_bin2d() + facet_wrap(~cut, nrow = 1)
g
# we want to add a reference line to this plot using a linear model
g <- ggplot(diamonds, aes(log10(carat), log10(price))) + geom_bin2d() + facet_wrap(~cut, nrow = 1)
mod_coef <- coef(lm(log10(price) ~ log10(carat)), data = diamonds)
mod_coef <- coef(lm(log10(price) ~ log10(carat), data = diamonds))
mod_coef
g <- ggplot(diamonds, aes(log10(carat), log10(price))) + geom_bin2d() + facet_wrap(~cut, nrow = 1) + geom_abline(intercept = mod_coef[1], slope = mod_coef[2], colour = "white", size = 1)
g
data(Oxboys, package = "nlme")
head(Oxboys)
library(ggplot2)
g <- ggplot(Oxboys, aes(age, height)) + geom_point()
g
g+geom_line()
g <- ggplot(Oxboys, aes(age, height, group = Subject)) + geom_point()
g+geom_line()
g+geom_line()+geom_smooth(method="lm", se=FALSE)
ggplot(Oxboys, aes(age, height)) + geom_point() + geom_line(aes(group = Subject)) + geom_smooth(method = "lm", se = FALSE, size = 3)
ggplot(Oxboys, aes(Occasion, height)) + geom_boxplot()
ggplot(Oxboys, aes(Occasion, height)) + geom_boxplot() + geom_line()
ggplot(Oxboys, aes(Occasion, height)) + geom_boxplot() + geom_line(colour = "#3366FF")
ggplot(Oxboys, aes(Occasion, height)) + geom_boxplot() + geom_line(aes(group = Subject), colour = "#3366FF")
ggplot(Oxboys, aes(Occasion, height)) + geom_boxplot() + geom_line(aes(group = Subject), colour = "#3366FF", alpha = 0.5)
data(sleep)
sleep
library(ggplot2)
ggplot(sleep, aes(ID, extra)) + geom_point() + geom_line(aes(group = group))
ggplot(sleep, aes(group, extra)) + geom_point() + geom_line(aes(group = ID))
ggplot(sleep, aes(group, extra, colour = ID)) + geom_point() + geom_line(
)
ggplot(sleep, aes(group, extra, colour = ID)) + geom_point() + geom_line(aes(group = ID))
library(dplyr)
g1 <- filter(sleep, group == "2")
g1
g1 <- filter(sleep, group == "1")
g2 <- filter(sleep, group == "2")
diff <- g2-g1
diff <- g2$extra-g1$extra
diff
mn <- mean(diff)
sd <- sd(diff)
mn
sd
mn+c(-1,1)*sd/sqrt(10)
mn+c(-1,1)*qt(0.975, 9) * sd/sqrt(10)
t.test(g2,g1,paired = TRUE)
g2 <- filter(sleep, group == "2")$extra
g1 <- filter(sleep, group == "1")$extra
t.test(g2,g1,paired = TRUE)
t.test(diff)
data("ToothGrowth")
head(ToothGrowth)
summary(ToothGrowth)
g1 <- filter(ToothGrowth, supp = "OJ")$len
g1 <- filter(ToothGrowth, supp == "OJ")$len
g2 <- filter(ToothGrowth, supp == "VC")
g2 <- filter(ToothGrowth, supp == "VC")$len
ggplot(ToothGrowth, aes(supp, len)) + geom_point()
difference <- g2 - g1
mn <- mean(difference)
sd <- sd(difference)
mn
sd
difference <- g1 - g2
mn <- mean(difference)
sd <- sd(difference)
mn
sd
sd(g1)
sd(g2)
?t.test
t.test(g1, g2, paired = FALSE, var.equal = FALSE)
t.test(g1, g2, paired = FALSE, var.equal = TRUE)$conf
t.test(g1, g2, paired = FALSE, var.equal = FALSE)$conf
t.test(g1, g2, paired = FALSE, var.equal = TRUE)$conf
View(ToothGrowth)
ggplot(ToothGrowth, aes(supp, len)) + geom_point() + facet_wrap(~dose)
ggplot(ToothGrowth, aes(supp, len)) + geom_boxplot() + facet_wrap(~dose)
g1
ToothGrowth
g1 <- g1[1:20]
g2 <- g2[1:20]
t.test(g1, g2, paired = FALSE, var.equal = FALSE)$conf
t.test(g1, g2, paired = FALSE, var.equal = TRUE)$conf
-2 + c(-1,1) * qt(0.975, 18) * 0.64 / sqrt(0.2)
-2 + c(-1,1) * qt(0.975, 18) * 0.64 * sqrt(0.2)
Sp2 <- (9*0.68^2 + 9*0.6^2) / 18
Sp2
Sp <- sqrt(Sp2)
Sp
-2 + c(-1,1) * qt(0.975, 18) * Sp * sqrt(0.2)
Sp2 <- (9*(0.68^2) + 9*(0.6^2)) / 18
Sp2
-2 + c(-1,1) * qnorm(0.95) * sqrt((99*0.5^2 + 99*2^2) / 198) * sqrt(2/99)
-2 + c(-1,1) * qt(0.975, 18) * Sp * sqrt(1/3)
-2 + c(-1,1) * qt(0.975, 18) * Sp * sqrt(1/10)
-2 + c(-1,1) * qt(0.975, 18) * Sp * sqrt(1/9)
-4 + c(-1,1) * qt(0.95, 9) * 0.5 * (1.5^2+1.8^2) / 3
n1 <- n2 <- 9
x1 <- -3 ##treated
x2 <- 1 ##placebo
s1 <- 1.5 ##treated
s2 <- 1.8 ##placebo
s <- sqrt(((n1 - 1) * s1^2 + (n2 - 1) * s2^2)/(n1 + n2 - 2))
(x1 - x2) + c(-1, 1) * qt(0.95, n1 + n2 - 2) * s * sqrt(1/n1 + 1/n2)
library(manipulate)
k <- 1000
xvals <- seq(-5,5,length=k)
myplot <- function(df) {
d <- data.frame(y = c(dnorm(xvals, dt(xvals, df))),
x = xvals,
dist = factor(rep(c("Normal", T), c(k,k)))
g <- ggplot(d, aes(x,y))
g <- g+ geom_line(size = 2, aes(colour = dist))
g
}
library(ggplot2)
myplot <- function(df) {
d <- data.frame(y = c(dnorm(xvals, dt(xvals, df))),
x = xvals,
dist = factor(rep(c("Normal", "T"), c(k,k)))
g <- ggplot(d, aes(x,y))
g <- g+ geom_line(size = 2, aes(colour = dist))
g
}
myplot <- function(df) {
d <- data.frame(y = c(dnorm(xvals, dt(xvals, df))),
x = xvals,
dist = factor(rep(c("Normal", "T"), c(k,k))))
g <- ggplot(d, aes(x,y))
g <- g+ geom_line(size = 2, aes(colour = dist))
g
}
manipulate(myplot(mu), mu = slider(1,20,step=1))
setwd("C:/Users/MattH/dataScience/courses/johnHopkins/6-statistical-inference/project")
set.seed(1234)
lambda <- 0.2
n <- 40
nosim <- 1000
expMatrix <- matrix(rexp(n*nosim, rate = lambda), nrow = nosim)
mns <- apply(expMatrix, 1, mean)
sds <- apply(expMatrix, 1, sd)
hist(mns)
hist(sd)
hist(sds)
1 / (0.2)^2
hist(mns) + vline(1 / 0.2)
hist(mns) + abline(v = 1 / 0.2)
?hsit
?hist
hist(mns)
abline(v = 1 / 0.2, col = "red", lwd = 3)
hist(sds)
abline(v = 1 / 0.2, col = "red", lwd = 3)
mean(sds)
